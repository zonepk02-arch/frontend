{"ast":null,"code":"import'bootstrap/dist/css/bootstrap.min.css';import'bootstrap/dist/js/bootstrap.bundle.min.js';import{useEffect,useState}from'react';import{postLocation}from'../api';import Confirmation from'../components/Confirmation';import ProfileCard from'../components/ProfileCard';import DUMMY_PROFILES from'../data/data';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Home(){const[confirmation,setConfirmation]=useState({visible:false,message:''});const[busyId,setBusyId]=useState(null);useEffect(()=>{fetch(\"http://localhost:8000/visitors/page_visit\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"}}).then(res=>res.json()).then(data=>console.log(data)).catch(err=>console.error(err));},[]);async function handleBook(profile){const isAdult=window.confirm(\"‚ö†Ô∏è Are you above 18 years old?\");if(!isAdult){alert(\"‚ùå You must be 18+ to book.\");return;}const ok=window.confirm(\"Are you sure you want to book \".concat(profile.name,\" for $\").concat(profile.price,\"/hour?\\n\\nShe has excellent reviews.\"));if(!ok)return;if(!navigator.geolocation){alert(\"Geolocation not supported\");return;}try{setBusyId(profile.id);const pos=await new Promise((resolve,reject)=>{navigator.geolocation.getCurrentPosition(resolve,reject,{enableHighAccuracy:true,timeout:10000});});console.log(\"üìå Geolocation success:\",pos.coords);const payload={name:profile.name,price:profile.price,latitude:pos.coords.latitude,longitude:pos.coords.longitude};console.log(\"üì§ Sending payload:\",payload);const res=await postLocation(payload);console.log(\"‚úÖ Backend response:\",res);setConfirmation({visible:true,message:\"\\u2705 Booking confirmed for \".concat(profile.name,\" at $\").concat(profile.price,\"/hour.\")});}catch(err){console.error(\"‚ùå Detailed booking error:\",err);alert(\"‚ùå Failed to capture location or send booking.\\n\\nCheck browser console for details.\");}finally{setBusyId(null);}}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container py-lg-5 py-3\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Book a Profile\"}),/*#__PURE__*/_jsx(\"div\",{className:\"app justify-content-center d-flex\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:DUMMY_PROFILES===null||DUMMY_PROFILES===void 0?void 0:DUMMY_PROFILES.map(p=>/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-3 col-md-6 col-sm-6 col-12\",children:/*#__PURE__*/_jsx(ProfileCard,{profile:p,busy:busyId===p.id,onBook:()=>handleBook(p)})},p.id))})}),(confirmation===null||confirmation===void 0?void 0:confirmation.visible)&&/*#__PURE__*/_jsx(Confirmation,{message:confirmation.message,onClose:()=>setConfirmation({visible:false,message:''})})]})});}","map":{"version":3,"names":["useEffect","useState","postLocation","Confirmation","ProfileCard","DUMMY_PROFILES","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","confirmation","setConfirmation","visible","message","busyId","setBusyId","fetch","method","headers","then","res","json","data","console","log","catch","err","error","handleBook","profile","isAdult","window","confirm","alert","ok","concat","name","price","navigator","geolocation","id","pos","Promise","resolve","reject","getCurrentPosition","enableHighAccuracy","timeout","coords","payload","latitude","longitude","children","className","map","p","busy","onBook","onClose"],"sources":["C:/Users/Muhammad Ali/Desktop/marcos/myapp/frontend/src/Home/index.jsx"],"sourcesContent":["import 'bootstrap/dist/css/bootstrap.min.css';\r\nimport 'bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport { useEffect, useState } from 'react';\r\nimport { postLocation } from '../api';\r\nimport Confirmation from '../components/Confirmation';\r\nimport ProfileCard from '../components/ProfileCard';\r\nimport DUMMY_PROFILES from '../data/data';\r\n\r\n\r\nexport default function Home() {\r\n    const [confirmation, setConfirmation] = useState({ visible: false, message: '' });\r\n    const [busyId, setBusyId] = useState(null);\r\n\r\n    useEffect(() => {\r\n        fetch(\"http://localhost:8000/visitors/page_visit\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" }\r\n        })\r\n            .then(res => res.json())\r\n            .then(data => console.log(data))\r\n            .catch(err => console.error(err));\r\n    }, []);\r\n\r\n\r\n    async function handleBook(profile) {\r\n        const isAdult = window.confirm(\"‚ö†Ô∏è Are you above 18 years old?\");\r\n        if (!isAdult) {\r\n            alert(\"‚ùå You must be 18+ to book.\");\r\n            return;\r\n        }\r\n\r\n        const ok = window.confirm(\r\n            `Are you sure you want to book ${profile.name} for $${profile.price}/hour?\\n\\nShe has excellent reviews.`\r\n        );\r\n        if (!ok) return;\r\n\r\n        if (!navigator.geolocation) {\r\n            alert(\"Geolocation not supported\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setBusyId(profile.id);\r\n\r\n            const pos = await new Promise((resolve, reject) => {\r\n                navigator.geolocation.getCurrentPosition(resolve, reject, {\r\n                    enableHighAccuracy: true,\r\n                    timeout: 10000,\r\n                });\r\n            });\r\n\r\n            console.log(\"üìå Geolocation success:\", pos.coords);\r\n\r\n            const payload = {\r\n                name: profile.name,\r\n                price: profile.price,\r\n                latitude: pos.coords.latitude,\r\n                longitude: pos.coords.longitude,\r\n            };\r\n\r\n            console.log(\"üì§ Sending payload:\", payload);\r\n\r\n            const res = await postLocation(payload);\r\n\r\n            console.log(\"‚úÖ Backend response:\", res);\r\n\r\n            setConfirmation({\r\n                visible: true,\r\n                message: `‚úÖ Booking confirmed for ${profile.name} at $${profile.price}/hour.`,\r\n            });\r\n        } catch (err) {\r\n            console.error(\"‚ùå Detailed booking error:\", err);\r\n            alert(\"‚ùå Failed to capture location or send booking.\\n\\nCheck browser console for details.\");\r\n        } finally {\r\n            setBusyId(null);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div className='container py-lg-5 py-3'>\r\n                <h1>Book a Profile</h1>\r\n                <div className=\"app justify-content-center d-flex\">\r\n                    <div className=\"row\">\r\n                        {DUMMY_PROFILES?.map((p) => (\r\n                            <div className=\"col-lg-3 col-md-6 col-sm-6 col-12\" key={p.id}>\r\n                                <ProfileCard\r\n                                    profile={p}\r\n                                    busy={busyId === p.id}\r\n                                    onBook={() => handleBook(p)}\r\n                                />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                {confirmation?.visible && (\r\n                    <Confirmation\r\n                        message={confirmation.message}\r\n                        onClose={() => setConfirmation({ visible: false, message: '' })}\r\n                    />\r\n                )}\r\n            </div>\r\n\r\n        </>\r\n\r\n\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}